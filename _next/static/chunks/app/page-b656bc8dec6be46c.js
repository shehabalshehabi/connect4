(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8549:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/connect4engine_bg.8a374b89.wasm"},5262:(e,t,n)=>{Promise.resolve().then(n.bind(n,3659))},3659:(e,t,n)=>{"use strict";let r;n.r(t),n.d(t,{default:()=>g});var l=n(5155),a=n(2115);n(4051);let s="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&s.decode();let i=null;function o(){return(null===i||0===i.byteLength)&&(i=new Uint8Array(r.memory.buffer)),i}let c=0,u="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},d="function"==typeof u.encodeInto?function(e,t){return u.encodeInto(e,t)}:function(e,t){let n=u.encode(e);return t.set(n),{read:e.length,written:n.length}};function f(e){let t=function(e,t,n){if(void 0===n){let n=u.encode(e),r=t(n.length,1)>>>0;return o().subarray(r,r+n.length).set(n),c=n.length,r}let r=e.length,l=t(r,1)>>>0,a=o(),s=0;for(;s<r;s++){let t=e.charCodeAt(s);if(t>127)break;a[l+s]=t}if(s!==r){0!==s&&(e=e.slice(s)),l=n(l,r,r=s+3*e.length,1)>>>0;let t=d(e,o().subarray(l+s,l+r));s+=t.written,l=n(l,r,s,1)>>>0}return c=s,l}(e,r.__wbindgen_malloc,r.__wbindgen_realloc),n=c;return r.c4engine(t,n)}async function h(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"!=e.headers.get("Content-Type"))console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t);else throw t}let n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{let n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}async function m(e){if(void 0!==r)return r;void 0!==e&&(Object.getPrototypeOf(e)===Object.prototype?{module_or_path:e}=e:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),void 0===e&&(e=new n.U(n(8549)));let t=function(){let e={};return e.wbg={},e.wbg.__wbg_alert_95821f81f7f6c07a=function(e,t){var n;alert((n=e>>>0,s.decode(o().subarray(n,n+t))))},e.wbg.__wbindgen_init_externref_table=function(){let e=r.__wbindgen_export_0,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},e}();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));let{instance:l,module:a}=await h(await e,t);return r=l.exports,m.__wbindgen_wasm_module=a,i=null,r.__wbindgen_start(),r}function g(){let[e,t]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{(async()=>{await m({global:{},env:{memory:new WebAssembly.Memory({initial:1e4,maximum:65536})}}),t(!0)})()},[]),(0,l.jsx)(y,{engineReady:e})}var b=function(e){return e[e.InProgress=0]="InProgress",e[e.Draw=1]="Draw",e[e.Player1Win=2]="Player1Win",e[e.Player2Win=3]="Player2Win",e}(b||{});function y(e){let{engineReady:t}=e,[n,r]=(0,a.useState)([Array(7).fill(0).map(()=>Array(6).fill(0))]),[s,i]=(0,a.useState)([]),[o,c]=(0,a.useState)(0),[u,d]=(0,a.useState)(0),[h,m]=(0,a.useState)(!1),[g,b]=(0,a.useState)(!1),[y,x]=(0,a.useState)(!1),[j,N]=(0,a.useState)(!1),[E,k]=(0,a.useState)(Array(7).fill(0)),[C,W]=(0,a.useState)(50);function A(){if(!t||0!=u)return;let e=-1,n=-127;for(let t=0;t<=6;t++){let r=f(s+t.toString()),l=-128==r?-128:-r;console.log("move_number",Math.floor(s.length/2)+1,"col=",t,"score=",l),l>n&&(e=t,n=l)}P(e)}function P(e){if(0!=u&&o==s.length)return;let t=n[o],l=!(o%2);for(let n=0;n<t[e].length;n++)if(0==t[e][n]){r(t=>{let r=t.slice(0,o+1),a=structuredClone(t[o]);return a[e][n]=l?1:2,r.push(a),function(e,t,n){let r=e[t][n];for(let l=n-3;l<=n&&!(l<0)&&e[t][l]==r;l++)if(l==n)return!0;let l=0,a,s=0;for(let i=-1;i<=1;i++){l=0;for(let o=-3;o<=3;o++){if(a=t+o,s=n+i*o,a<0||a>=7||s<0||s>=6){l=0;continue}if(e[a][s]==r){if((l+=1)>=4)return!0}else l=0}}return!1}(a,e,n)?l?d(2):d(3):41==o?d(1):d(0),r}),i(t=>{let n=t.slice(0,o);return n.push(e),n}),c(e=>e+1);break}}return(0,a.useEffect)(()=>{if(t&&j){let e=Array(7).fill(0),t=s.slice(0,o);for(let n=0;n<=6;n++){let r=-f(t+n.toString());e[n]=r}k(e)}},[t,s,j,o]),(0,a.useEffect)(()=>{if(t&&y){let e=s.slice(0,o),t=f(e.toString());W(((e.length%2==0?t:-t)+22)*100/44)}},[t,s,y,o]),(0,a.useEffect)(()=>{s.length%2==0?h&&A():g&&A()},[t,s,h,g]),(0,l.jsx)("div",{className:"game-container",children:(0,l.jsxs)("div",{className:"game-ui",children:[(0,l.jsx)(_,{gameResult:u,player1Turn:!(o%2),finalPly:o==s.length}),(0,l.jsxs)("div",{className:"game-board-and-history",children:[y&&(0,l.jsx)(w,{red:C}),(0,l.jsx)(v,{boardState:n[o],playTurn:P,moveEvals:E,showMoveEvals:j}),(0,l.jsx)(S,{gotoMove:function(e){e<0||e>=n.length||c(e)},moveHistory:s,currentPly:o})]}),(0,l.jsx)(p,{engineP1:h,setEngineP1:m,engineP2:g,setEngineP2:b,showEvalBar:y,setShowEvalBar:x,showMoveEvals:j,setShowMoveEvals:N})]})})}function v(e){let{boardState:t,playTurn:n,moveEvals:r,showMoveEvals:a}=e,s=t.map((e,t)=>(0,l.jsx)(x,{columnState:e,playColumn:()=>n(t),moveEval:r[t],showMoveEvals:a},t));return(0,l.jsx)("div",{className:"board",children:s})}function x(e){let{columnState:t,playColumn:n,moveEval:r,showMoveEvals:a}=e,s=t.map((e,t)=>(0,l.jsx)(j,{slotState:e},t));return(0,l.jsxs)("div",{className:"column",onClick:n,children:[s,a&&(0,l.jsx)(l.Fragment,{children:r})]})}function w(e){let{red:t}=e,n={height:t.toString()+"%"},r={height:(100-t).toString()+"%"};return(0,l.jsxs)("div",{className:"eval-bar",children:[(0,l.jsx)("div",{className:"yellow-eval",style:r}),(0,l.jsx)("div",{className:"red-eval",style:n})]})}function p(e){let{engineP1:t,setEngineP1:n,engineP2:r,setEngineP2:a,showEvalBar:s,setShowEvalBar:i,showMoveEvals:o,setShowMoveEvals:c}=e,u=(0,l.jsx)("button",{onClick:()=>n(e=>!e),className:t?"activated":"deactivated",children:"Engine Player 1"}),d=(0,l.jsx)("button",{onClick:()=>a(e=>!e),className:r?"activated":"deactivated",children:"Engine Player 2"}),f=(0,l.jsx)("button",{onClick:()=>c(e=>!e),className:o?"activated":"deactivated",children:"Show Move Evals"}),h=(0,l.jsx)("button",{onClick:()=>i(e=>!e),className:s?"activated":"deactivated",children:"Show Eval Bar"});return(0,l.jsxs)("div",{className:"engine-controls",children:[u,d,f,h]})}function j(e){let{slotState:t}=e,n="slot";return 1==t?n+=" player1":2==t&&(n+=" player2"),(0,l.jsx)("div",{className:n})}function _(e){let{gameResult:t,player1Turn:n,finalPly:r}=e;return(0,l.jsx)("div",{className:"game-status",children:r&&0!==t?1==t?"Draw":2==t?"Red Wins":"Yellow Wins":n?"Red's Turn":"Yellow's Turn"})}function S(e){let{gotoMove:t,moveHistory:n,currentPly:r}=e,a=n.reduce((e,t,n)=>(n%2==0?e.push([t+1]):e[e.length-1].push(t+1),e),[]);return(0,l.jsxs)("div",{className:"game-history",children:[(0,l.jsxs)("div",{className:"control-panel",children:[(0,l.jsx)("button",{onClick:()=>t(0),children:"<<"}),(0,l.jsx)("button",{onClick:()=>t(r-1),children:"<"}),(0,l.jsx)("button",{onClick:()=>t(r+1),children:">"}),(0,l.jsx)("button",{onClick:()=>t(n.length),children:">>"})]}),(0,l.jsx)("table",{children:(0,l.jsx)("tbody",{children:a.length>0?a.map((e,n)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{onClick:()=>t(2*n),children:n+1}),(0,l.jsx)("td",{onClick:()=>t(2*n+1),className:r==2*n+1?"current-move":"",children:e[0]}),(0,l.jsx)("td",{onClick:()=>t(2*n+2),className:r==2*n+2?"current-move":"",children:2==e.length&&e[1]})]},n)):(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"1"}),(0,l.jsx)("td",{}),(0,l.jsx)("td",{})]})})})]})}},4051:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[690,441,517,358],()=>t(5262)),_N_E=e.O()}]);